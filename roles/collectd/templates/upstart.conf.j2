# This file was generated by Ansible for {{ansible_fqdn}}
# Do NOT modify this file by hand!

description "start/stop/control collectd"
start on started networking and filesystem
stop on runlevel [!2345]

env DAEMON={{collectd_prefix_sbin}}/collectd

# Tell upstart to watch for forking when tracking the pid for us.
{% if collectd_version | version_compare('5.12.0', '>=') %}
expect stop
{% else %}
expect fork
{% endif %}

# prevent thrashing - 10 restarts in 5 seconds
respawn
respawn limit 10 5

# Make a log available in /var/log/upstart/collectd.log
console log

# The daemon will not start if the configuration is invalid.
pre-start exec $DAEMON -t
# Let's Fork!
exec $DAEMON